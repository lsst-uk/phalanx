{
  "$defs": {
    "ConditionalSecretConfig": {
      "additionalProperties": false,
      "description": "Possibly conditional specification for an application secret.",
      "properties": {
        "copy": {
          "anyOf": [
            {
              "$ref": "#/$defs/ConditionalSecretCopyRules"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Rules for where the secret should be copied from"
        },
        "description": {
          "title": "Description",
          "type": "string"
        },
        "generate": {
          "anyOf": [
            {
              "$ref": "#/$defs/ConditionalSimpleSecretGenerateRules"
            },
            {
              "$ref": "#/$defs/ConditionalSourceSecretGenerateRules"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Generate"
        },
        "if": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Configuration only applies if this Helm chart setting is set to a true value",
          "title": "Condition"
        },
        "onepassword": {
          "allOf": [
            {
              "$ref": "#/$defs/SecretOnepasswordConfig"
            }
          ],
          "default": {
            "encoded": false
          }
        },
        "value": {
          "anyOf": [
            {
              "format": "password",
              "type": "string",
              "writeOnly": true
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Value"
        }
      },
      "required": [
        "description"
      ],
      "title": "ConditionalSecretConfig",
      "type": "object"
    },
    "ConditionalSecretCopyRules": {
      "additionalProperties": false,
      "description": "Possibly conditional rules for copying a secret value from another.",
      "properties": {
        "application": {
          "title": "Application",
          "type": "string"
        },
        "if": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Configuration only applies if this Helm chart setting is set to a true value",
          "title": "Condition"
        },
        "key": {
          "title": "Key",
          "type": "string"
        }
      },
      "required": [
        "application",
        "key"
      ],
      "title": "ConditionalSecretCopyRules",
      "type": "object"
    },
    "ConditionalSimpleSecretGenerateRules": {
      "additionalProperties": false,
      "description": "Conditional rules for generating a secret value with no source.",
      "properties": {
        "if": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Configuration only applies if this Helm chart setting is set to a true value",
          "title": "Condition"
        },
        "type": {
          "enum": [
            "password",
            "gafaelfawr-token",
            "fernet-key",
            "rsa-private-key"
          ],
          "title": "Type",
          "type": "string"
        }
      },
      "required": [
        "type"
      ],
      "title": "ConditionalSimpleSecretGenerateRules",
      "type": "object"
    },
    "ConditionalSourceSecretGenerateRules": {
      "description": "Conditional rules for generating a secret from another secret.",
      "properties": {
        "if": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Configuration only applies if this Helm chart setting is set to a true value",
          "title": "Condition"
        },
        "source": {
          "title": "Source",
          "type": "string"
        },
        "type": {
          "enum": [
            "bcrypt-password-hash",
            "mtime"
          ],
          "title": "Type",
          "type": "string"
        }
      },
      "required": [
        "type",
        "source"
      ],
      "title": "ConditionalSourceSecretGenerateRules",
      "type": "object"
    },
    "SecretOnepasswordConfig": {
      "description": "Configuration for how a static secret is stored in 1Password.",
      "properties": {
        "encoded": {
          "default": false,
          "title": "Encoded",
          "type": "boolean"
        }
      },
      "title": "SecretOnepasswordConfig",
      "type": "object"
    }
  },
  "$id": "https://phalanx.lsst.io/schemas/secrets.json",
  "additionalProperties": {
    "$ref": "#/$defs/ConditionalSecretConfig"
  },
  "title": "Phalanx application secret definitions",
  "type": "object"
}
